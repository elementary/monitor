{
  "app-id": "com.github.stsdc.monitor",
  "runtime": "io.elementary.Platform",
  "runtime-version": "6.1",
  "sdk": "io.elementary.Sdk",
  "command": "com.github.stsdc.monitor",
  "finish-args": [
    "--allow=devel",
    "--share=ipc",
    "--socket=fallback-x11",
    "--device=dri",
    "--socket=wayland",
    "--socket=system-bus",
    "--device=all",
    "--share=network",
    "--talk-name=org.freedesktop.Flatpak",
    "--system-talk-name=org.freedesktop.Accounts",
    "--system-talk-name=org.freedesktop.UDisks2"
  ],
  "modules": [
    {
      "name": "sassc",
      "cleanup": [
        "*"
      ],
      "sources": [
        {
          "type": "git",
          "url": "https://github.com/sass/sassc.git",
          "tag": "3.6.2"
        },
        {
          "type": "script",
          "dest-filename": "autogen.sh",
          "commands": [
            "autoreconf -si"
          ]
        }
      ],
      "modules": [
        {
          "name": "pam",
          "config-opts": [
            "--includedir=/app/include/security",
            "--disable-doc"
          ],
          "sources": [
            {
              "type": "archive",
              "url": "https://github.com/linux-pam/linux-pam/releases/download/v1.4.0/Linux-PAM-1.4.0.tar.xz",
              "sha256": "cd6d928c51e64139be3bdb38692c68183a509b83d4f2c221024ccd4bcddfd034"
            }
          ]
        },
        {
          "name": "polkit",
          "buildsystem": "meson",
          "config-opts": [
            "-Dlibs-only=true",
            "-Dauthfw=pam"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://gitlab.freedesktop.org/stsdc/polkit.git",
              "branch": "polkit-agent-building-option"
            }
          ]
        },
        {
          "name": "udisks2",
          "buildsystem": "autotools",
          "config-opts": [
            "--enable-available-modules=no",
            "--enable-bcache=no",
            "--enable-btrfs=no",
            "--enable-introspection=yes",
            "--enable-lvm2=no",
            "--enable-modules=no",
            "--enable-vdo=no",
            "--enable-zram=no",
            "--with-systemdsystemunitdir=no",
            "--with-tmpfilesdir=no",
            "--disable-daemon"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://github.com/storaged-project/udisks.git",
              "tag": "udisks-2.9.4"
            }
          ]
        },
        {
          "name": "libsass",
          "cleanup": [
            "*"
          ],
          "sources": [
            {
              "type": "git",
              "url": "https://github.com/sass/libsass.git",
              "tag": "3.6.5"
            },
            {
              "type": "script",
              "dest-filename": "autogen.sh",
              "commands": [
                "autoreconf -si"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "libstartup-notification",
      "sources": [
        {
          "type": "archive",
          "url": "http://www.freedesktop.org/software/startup-notification/releases/startup-notification-0.12.tar.gz",
          "sha256": "3c391f7e930c583095045cd2d10eb73a64f085c7fde9d260f2652c7cb3cfbe4a"
        }
      ]
    },
    {
      "name": "libwnck",
      "buildsystem": "meson",
      "config-opts": [
        "-Dstartup_notification=enabled"
      ],
      "cleanup": [
        "/include",
        "/lib/pkgconfig",
        "/bin"
      ],
      "sources": [
        {
          "type": "archive",
          "url": "https://download.gnome.org/sources/libwnck/3.36/libwnck-3.36.0.tar.xz",
          "sha256": "bc508150b3ed5d22354b0e6774ad4eee465381ebc0ace45eb0e2d3a4186c925f"
        }
      ]
    },
    {
      "name": "libgtop",
      "sources": [
        {
          "type": "archive",
          "url": "https://download.gnome.org/sources/libgtop/2.40/libgtop-2.40.0.tar.xz",
          "sha256": "78f3274c0c79c434c03655c1b35edf7b95ec0421430897fb1345a98a265ed2d4"
        }
      ]
    },
    {
      "name": "libNVCtrl",
      "build-options": {
        "env": {
          "LIB": "lib/x86_64-linux-gnu"
        }
      },
      "no-autogen": true,
      "no-make-install": true,
      "build-commands": [
        "mkdir -p ${FLATPAK_DEST}/lib",
        "cp -a libXNVCtrl.so* ${FLATPAK_DEST}/lib/",
        "install -D *.h -t ${FLATPAK_DEST}/include/NVCtrl"
      ],
      "subdir": "src/libXNVCtrl",
      "sources": [
        {
          "type": "archive",
          "archive-type": "tar",
          "url": "https://api.github.com/repos/NVIDIA/nvidia-settings/tarball/refs/tags/470.63.01",
          "sha256": "0ede63515851d85ac0d1ed5f00e355f539968e6d1fd226120a27b2c66c3575de"
        },
        {
          "type": "patch",
          "path": "flatpak/patches/libxnvctrl_so_0.patch",
          "x-checker-data": {
            "type": "json",
            "url": "https://api.github.com/repos/NVIDIA/nvidia-settings/tags",
            "url-query": ".[0].tarball_url",
            "version-query": ".[0].name"
          }
        }
      ]
    },
    {
      "name": "com.github.stsdc.monitor",
      "buildsystem": "meson",
      "sources": [
        {
          "type": "dir",
          "path": "."
        }
      ]
    }
  ]
}